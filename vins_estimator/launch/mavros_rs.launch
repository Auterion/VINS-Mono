<?xml version="1.0" encoding="UTF-8"?> 
<launch> 
    <arg name="fcu_url" default="udp://:14540@localhost:14557"/>

    <arg name="cam_fps" default="30"/>
    <arg name="enable_rosbag" default="false"/>
    <arg name="bag_prefix" default="rs"/>
    <arg name="hw_sync"   default="true"/>

    <include file="$(find rovio)/launch/mavros.launch"/>
    <node name="convert_mavros_stamps" pkg="topic_tools" type="transform"
        args="/mavros/cam_imu_sync/cam_imu_stamp /hw_stamp std_msgs/Header
        'std_msgs.msg.Header(seq=m.frame_seq_id, stamp=m.frame_stamp)' --import std_msgs"/>

    <include file="$(find realsense2_camera)/launch/rs_camera.launch">
        <arg name="enable_color" value="false"/>
        <arg name="enable_infra2" value="false"/>
        <arg name="infra1_fps" value="$(arg cam_fps)"/>
        <arg name="depth_fps" value="$(arg cam_fps)"/>
        <arg name="enable_external_hw_sync"    value="$(arg hw_sync)"/>
        <arg name="static_time_offset"  value="0.009"/>
        <arg name="inter_cam_sync_mode" value="1" if="$(arg hw_sync)"/>
    </include>

    <node name="set_RS_param" pkg="realsense2_camera" type="realsense_params_RX.sh" />

    <node pkg="rosbag" type="record" name="rosbag_record_cam_imu" if="$(arg enable_rosbag)"
      args="record -o $(env AUTERION_WS)/$(arg bag_prefix) 
      /camera/infra1/image_rect_raw /camera/infra1/camera_info
      /mavros/imu/data_raw
      /mavros/cam_imu_sync/cam_imu_stamp 
      /mavros/local_position/pose /mavros/global_position/local /mavros/global_position/global
      /mavros/vision_pose/pose"
    />
</launch>
